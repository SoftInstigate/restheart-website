<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->

<html lang="en">
<!--<![endif]-->
<head>
   <meta charset="utf-8">
   <title>RESTHeart - Speedup Requests with Cursor Pools</title>
   <meta name="description" content="Low code API Framework for MongoDB">
   <meta name="author" content="SoftInstigate srl">
   <meta name="keywords" content="restheart,mongodb,rest,,graphql,api,http,microservice,java,framework">
   <!-- Open Graph -->
   <meta property="og:type" content="website">
   <meta property="og:url" content="https://restheart.org">
   <meta property="og:logo" content="/images/restheart logo.svg">
   <meta property="og:title" content="RESTHeart - Speedup Requests with Cursor Pools">
   <meta property="og:description" content="Low code API Framework for MongoDB">
   <meta property="og:locale" content="en">
   
   <!-- avoid search engine indexing of old documentation pages  -->
   <meta name="robots" content="noindex,nofollow">
   
   <!-- Mobile Specific Metas -->
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   <!-- icon fonts -->
   <script src="/js/fontawesome.com_c39cf060d4.js"></script>
   <link type="text/css" rel="stylesheet" href="/font-icons/custom-icons/css/custom-icons.css">
   <link type="text/css" rel="stylesheet" href="/font-icons/custom-icons/css/custom-icons-ie7.css">
   <!-- Custom css -->
   <link rel="stylesheet" type="text/css" href="/css/main.css">
   <!-- js ================================================== -->
   <script src="https://code.jquery.com/jquery.min.js"></script>
   <script src="/assets/js/bootstrap.bundle.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js"></script>
   <script src="https://unpkg.com/@stackblitz/sdk/bundles/sdk.umd.js"></script>
   <script src="/js/carousel.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.min.js"></script>
   <!-- Github buttons. -->
   <script async defer src="https://buttons.github.io/buttons.js"></script>
   <!--iframeResizer-->
  <script src="/assets/js/iframe-resizer.parent.js"></script>
   <!-- Favicons ================================================== -->
  <link rel="icon" type="image/svg+xml" href="/images/restheart logo.svg" />
  <link rel="shortcut icon" href="/images/favicon/favicon.png" />
  <link rel="canonical" href="https://restheart.org/docs/v5/speedup-requests-with-cursor-pools">
  <link rel="alternate" type="application/atom+xml" title="RESTHeart - API Framework" href="https://restheart.org/feed.xml" />
  <script defer data-domain="restheart.org" src="https://plausible.io/js/script.js"></script>
</head>


<body>
    <header id="mainHeader" class="fixed-top background-primary" role="banner">
    <div class="container-fluid">
        <nav class="navbar navbar-default scrollMenu navbar-expand-lg" role="navigation">
            <a class="navbar-brand" href="/">
                <h2 class="text-white"><strong>REST</strong>Heart</h2>
            </a>
            <!-- Place this tag where you want the button to render. -->
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target=".navbar-ex1-collapse"><span
                    class="sr-only">Toggle navigation</span> &#x2630;</button>
            <div class="collapse navbar-collapse navbar-ex1-collapse background-primary" id="scrollTarget">
                <ul class="nav navbar-nav ml-md-auto">
                    <!-- only bounce slack button on home page-->
                    
                    

                    <li class="nav-item ml-1 ml-lg-2 ml-xl-4 mb-0 pb-0 ">
                        <a class="github-button" href="https://github.com/SoftInstigate/restheart" data-size="large" data-show-count="true" aria-label="Star SoftInstigate/restheart on GitHub"></a>
                    </li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/docs/sophia">Ask Sophia</a></li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/docs">Docs</a></li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/docs/faq">FAQ</a></li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/docs/setup-with-docker/">GET</a></li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/contact">Contacts</a></li>
                </ul>
            </div>
        </nav>
    </div>
</header>

<div class="alert alert-warning m-0 text-center" role="alert">
    <strong>RESTHeart 8 is the current stable release. Switch documentation to <a href="/docs">v8</a></strong>
</div>



<a  target="_blank" class="gitter-open-chat-button fixed-bottom-right" href="https://join.slack.com/t/restheart/shared_invite/zt-1olrhtoq8-5DdYLBWYDonFGEALhmgSXQ"></a>


    <div class="page-content">
        <div class="container-fluid imgHover doc">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
            <div class="bd-sidebar__head">
                <div class="dropdown d-flex justify-content-center w-100">
                    <button class="btn btn-secondary dropdown-toggle w-100 p-1 mb-2" type="button"
                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        v5
                    </button>
                    <div class="dropdown-menu mt-2 mr-1 pb-2" aria-labelledby="dropdownMenuButton">
                      <a class="dropdown-item" href="/docs">
                            
                            v8
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v7">
                            
                            v7
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v6">
                            
                            v6
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v5">
                            
                            <strong>v5</strong>
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v4">
                            
                            v4
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v3">
                            
                            v3
                            
                        </a>
                    </div>
                </div>
                <form action="https://www.google.com/search" class="form bd-sidebar__search d-flex" method="get"
                    name="searchform" target="_blank">
                    <input name="sitesearch" type="hidden" value="restheart.org/docs">
                    <input autocomplete="on" class="form-control input-sm search bd-sidebar__input" name="q"
                        placeholder="Search" required="required" type="text">
                    <button class="bd-sidebar__submit" type="submit">
                        <svg width="16" height="16">
                            <use xlink:href="/images/sprite.svg#search" /></svg>
                    </button>
                </form>
                <div class="d-flex flex-wrap justify-content-between align-items-center">
                    <a href="https://github.com/SoftInstigate/restheart-website/edit/master/docs/v5/speedup-requests-with-cursor-pools.md"
                        class="small mt-2 mb-1 ml-lg-auto"><i class="icon-pencil"></i>Edit Page</a>
                    <button class="btn btn-link bd-sidebar__toggle navbar-expand-md p-0 mb-1 d-md-none" type="button"
                        data-toggle="collapse" data-target="#bd-sidebar__menu" aria-controls="bd-sidebar__menu"
                        aria-expanded="false" aria-label="Toggle docs navigation">
                        Table of Contents
                        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 30 30" width="30" height="30"
                            focusable="false">
                            <title>Menu</title>
                            <path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10"
                                d="M4 7h22M4 15h22M4 23h22" />
                        </svg>
                    </button>
                </div>
            </div>

            <div class="bd-sidebar__menu collapse d-md-block" id="bd-sidebar__menu">
                
                    <h2 id="get-started"><a href="/docs/v5">Get Started</a></h2>
<ul>
    <li><a href="/docs/v5/setup">Setup</a></li>
    <li><a href="/docs/v5/try">Try RESTHeart online</a></li>
    <li><a href="/docs/v5/tutorial">Absolute Beginner Tutorial</a></li>
    <li><a href="/docs/v5/video-tutorials"><strong>Video Tutorials</strong></a></li>
    <li><a href="/docs/v5/quick-reference">Quick Reference</a></li>
    <li><a href="/docs/v5/resource-uri">Resource URIs</a></li>
    <li><a href="/docs/v5/graalvm">GraalVM</a></li>
    <li><a href="/docs/v5/representation-format">Representation Format</a></li>
    <li><a href="/docs/v5/logging">Logging</a></li>
    <li><a href="/docs/v5/blog-posts">Other tutorials</a></li>
    <li><a href="/docs/v5/performances">Performances</a></li>
    <li><a href="/docs/v5/clustering">Clustering & Load Balancing</a></li>
    <li><a href="/docs/v5/enterprise-license">Enterprise License</a></li>
</ul>

<h2 id="upgrade-to-v5"><a href="/docs/v5/upgrade-to-v5">Upgrade to v5</a></h2>
<h2 id="roadmap"><a href="/docs/v5/roadmap">Roadmap</a></h2>

<h2 id="content-api">Content API</h2>
<ul>
    <li><a href="/docs/v5/read-docs">Read JSON Documents</a></li>
    <li><a href="/docs/v5/write-docs">Write JSON Documents</a></li>
    <li><a href="/docs/v5/files">Binary Files with GridFS</a></li>
    <li><a href="/docs/v5/aggregations">Aggregations</a></li>
    <li><a href="/docs/v5/csv">Upload CSV files</a></li>
    <li><a href="/docs/v5/json-schema-validation">JSON Schema Validation</a></li>
    <li><a href="/docs/v5/change-streams">Change Streams</a></li>
    <li><a href="/docs/v5/transactions">Transactions</a></li>
</ul>

<h2 id="mgmt-api">Management API</h2>
<ul>
    <li><a href="/docs/v5/mgmt/dbs-collections">Databases and Collections</a></li>
    <li><a href="/docs/v5/mgmt/indexes">Indexes</a></li>
    <li><a href="/docs/v5/mgmt/relationships">Relationships</a></li>
</ul>

<h2 id="security">Securing Requests</h2>
<ul>
    <li><a href="/docs/v5/security/overview">Overview</a></li>
    <li><a href="/docs/v5/security/authentication">Authentication</a></li>
    <li><a href="/docs/v5/security/authorization">Authorization</a></li>
    <li><a href="/docs/v5/security/user-management">User Management</a></li>
    <li><a href="/docs/v5/security/tls">Configure TLS</a></li>
    <li><a href="/docs/v5/security/secure-connection-to-mongodb">Secure connection to MongoDB</a></li>
    <li><a href="/docs/v5/security/how-clients-authenticate">How Clients Authenticate</a></li>
</ul>

<h2 id="plugins">Plugins</h2>
<ul>
    <li><a href="/docs/v5/plugins/overview">Overview</a></li>
    <li><a href="/docs/v5/plugins/dev-env">Development Environment Setup</a></li>
    <li><a href="/docs/v5/plugins/core-plugins">Core Plugins</a></li>
    <li><a href="/docs/v5/plugins/security-plugins">Security Plugins</a></li>
    <li><a href="/docs/v5/plugins/deploy">How to deploy a Plugin</a></li>
</ul>

<h2 id="other-fatures">Other Features</h2>
<ul>
    <li><a href="/docs/v5/proxy">Proxying requests</a></li>
    <li><a href="/docs/v5/static-resources">Serving static resources</a></li>
    <li><a href="/docs/v5/etag">ETag</a></li>
    <li><a href="/docs/v5/cors-support">CORS Support</a></li>
    <li><a href="/docs/v5/shard-keys">Shard Keys</a></li>
    <li><a href="/docs/v5/speedup-requests-with-cursor-pools">Cursor Pools</a></li>
    <li><a href="/docs/v5/monitoring">Monitoring</a></li>
    <li><a href="/docs/v5/auditing">Auditing</a></li>
</ul>
                
            </div>
        </div>
        <div class="d-none d-xl-block col-xl-2 order-last bd-toc">

  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#how-it-works">How it works</a></li>
    <li><a href="#request-parameters">Request parameters</a></li>
    <li><a href="#configuration">Configuration</a></li>
    <li><a href="#consideration-on-concurrent-insertions">Consideration on concurrent insertions</a></li>
  </ul>

</div>
<div class="col-12 col-md-9 col-xl-8 py-md-3 bd-content">

  <div class="docs-head d-flex align-items-center justify-content-between">
    <h2 class="d-flex align-items-center m-0 pr-3">
        <span>Speedup Requests with Cursor Pools</span>
    </h2>
</div>

  <h2 id="introduction">Introduction</h2>

  <p>RESTHeart speedups the execution of GET requests to collections
resources via its <strong>db cursors pre-allocation engine</strong>. </p>

  <p>This applies when several documents need to be read from a big
collection and moderates the effects of the
MongoDB <a href="https://docs.mongodb.org/manual/reference/method/cursor.skip/#cursor.skip">cursor.skip()</a> method
<strong>that slows downs linearly</strong>.</p>

  <p>In common scenarios, RESTHeart’s db cursor pre-allocation engine allows
to deliver brilliant performances, even up to a 1000% increase over
querying MongoDB directly with its Java driver.</p>

  <p>Refer to the <a href="/docs/performances">Performances</a> section for more information
and real case results.</p>

  <p>Let’s first clarify the issue addressed by the engine.</p>

  <p>RESTHeart allows to <a href="/docs/read-docs/">Read Documents</a> via GET requests
on collection resources where documents are returned as embedded
resources.</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /test/coll?count&amp;page=3&amp;pagesize=10 HTTP/1.1

HTTP/1.1 200 OK

[
    { &lt;DOC30&gt; }, { &lt;DOC31&gt; }, ... { &lt;DOC39&gt; }
]
</code></pre></div>  </div>

  <p>Of course documents are returned as <strong>paginated</strong> result sets, i.e. each
request returns a limited number of documents.</p>

  <p>Pagination is controlled via the following query parameters:</p>

  <ul>
    <li><code class="language-plaintext highlighter-rouge">page</code>: the range of documents to return</li>
    <li><code class="language-plaintext highlighter-rouge">pagesize</code>: the number of documents to return (default value is 100,
maximum is 1000).</li>
  </ul>

  <p><strong>Behind the scene, this is implemented via the MongoDB <em>cursor.skip()</em>
method; </strong></p>

  <p>The issue is that MongoDB queries with a large “skip” slow down
linearly. As the MongoDB manual says:</p>

  <p class="bs-callout bs-callout-info">The cursor.skip() method is often expensive because it requires the server to walk from the beginning of the collection or index to get the offset or skip position before beginning to return result. As offset (e.g. pageNumber above) increases, cursor.skip() will become slower and more CPU intensive. With larger collections, cursor.skip() may become IO bound.</p>

  <p>That is why the MongoDB documentation section about
<a href="https://docs.mongodb.org/manual/reference/method/cursor.skip/#cursor.skip">skips</a>
suggests:</p>

  <p class="bs-callout bs-callout-info">Consider using range-based pagination for these kinds of tasks. That is, query for a range of objects, using logic within the application to determine the pagination rather than the database itself. This approach features better index utilization, if you do not need to easily jump to a specific page.</p>

  <h2 id="how-it-works">How it works</h2>

  <p>When RESTHeart detects a query involving many skips (with a big <em>page</em>
query parameter), in parallel it starts pre-allocating other cursors
(with same sort, filter and projection parameters) in a pool; further
similar requests will be served much quicker because the cursors needed
to retrieve the data will probably be in the pool and already skipped.</p>

  <ul>
    <li>Requests involving less skips
than eager-cursor-allocation-linear-slice-width parameter value,
will not trigger the pre-allocation of cursors.</li>
    <li>A request involving to skip N documents will use a cursor from the
pool only if it has been skipped by more than 90% of N documents
(tests suggests this to be the case).</li>
    <li>Cursors will last in the pool for 8 minutes (MongoDB will timeout
the cursors in 10 minutes anyway).</li>
    <li>Two different cursors allocation policies can be applied and
controlled by the <em>eager</em> query parameter: LINEAR and RANDOM. The
former will better improve a linear scanning of the collection
(reading pages in sequence), the latter, random accesses.</li>
  </ul>

  <p>The difference between the two policies is that in the LINEAR case, a
configurable number of cursors are allocated <strong>near</strong> the original
request, following the <a href="https://en.wikipedia.org/wiki/Locality_of_reference">principle of
locality</a>; in the
RANDOM case, a configurable number of cursors is allocated uniformly.</p>

  <p>The following images depicts how it works, in the LINEAR case:</p>

  <ol>
    <li><strong>Request A</strong> asks for 5 documents starting from the 1.000.000th
document. MongoDB needs to generate a cursor skipping 1.000.000
documents: this takes time to complete;</li>
    <li>Asynchronously, the <strong>db cursor pre-allocation engine</strong> creates few
cursor in the pool (<em>delta</em>, <em>slice width</em> and actual number of
cursors being configurable);</li>
    <li><strong>Request B</strong> asks for 5 documents starting for the next page.
RESTHeart finds cursor in the pool that has been already skipped. In
this case, only 3 more skips are needed.</li>
  </ol>

  <p><img src="/images/attachments/9207943/12058633.png?width=640" alt="" width="640" height="400" class="image-center img-responsive" /></p>

  <p>The following images depicts how it works, in the RANDOM case:</p>

  <ol>
    <li><strong>Request A</strong> asks for 5 documents starting from the 1.000.000th
document (page=200.000). MongoDB needs to generate a cursor skipping
1.000.000 documents that takes time to complete;</li>
    <li>Asynchronously, the <strong>db cursor pre-allocation engine</strong> creates few
cursor in the pool (<em>slice width</em> and actual number of cursors being
configurable)</li>
    <li><strong>Request B</strong> asks for the 250.000th page. RESTHeart finds a cursor
in the pool that has been already skipped. In the worst case only
<em>slice width</em> skips are needed.</li>
  </ol>

  <p><img src="/images/attachments/9207943/12058637.png?width=640" alt="" width="640" class="image-center img-responsive" /></p>

  <h2 id="request-parameters">Request parameters</h2>

  <p>The engine is controlled by the <em>eager</em> query parameter. Possible values
are:</p>
  <div class="table-responsive">
<table class="ts">
<colgroup>
<col class="w-33" />
<col class="w-33" />
<col class="w-33" />
</colgroup>
<thead>
<tr class="header">
<th><div>
value
</div></th>
<th><div>
description
</div></th>
<th><div>
default
</div></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong><code>linear</code></strong></td>
<td>LINEAR policy</td>
<td>√</td>
</tr>
<tr class="even">
<td><strong><code>random</code></strong></td>
<td>allocate cursors RANDOM policy</td>
<td> </td>
</tr>
<tr class="odd">
<td><strong><code>none</code></strong></td>
<td>the cursor pool will not be used</td>
<td> </td>
</tr>
</tbody>
</table>
</div>
  <p>Example</p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GET /test/coll?count&amp;page=1000&amp;pagesize=1000&amp;eager=random HTTP/1.1
</code></pre></div>  </div>

  <h2 id="configuration">Configuration</h2>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## eager db cursor preallocation policy
# in big collections, reading a far page involves skipping the db cursor for many documents resulting in a performance bottleneck
# for instance, with default pagesize of 100, a GET with page=50.000 involves 500.000 skips on the db cursor.
# the eager db cursor preallocation engine boosts up performaces (in some use cases, up to 1000%). the following options control its behavior.

eager-cursor-allocation-pool-size: 100
eager-cursor-allocation-linear-slice-width: 1000
eager-cursor-allocation-linear-slice-delta: 100
eager-cursor-allocation-linear-slice-heights: [ 4, 2, 1 ]
eager-cursor-allocation-random-max-cursors: 20
eager-cursor-allocation-random-slice-min-width: 1000
</code></pre></div>  </div>
  <div class="table-responsive">
<table class="ts">
<colgroup>
<col class="w-50" />
<col class="w-50" />
</colgroup>
<thead>
<tr class="header">
<th>parameter</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><pre class="black-code"><code>eager-cursor-allocation-pool-size</code></pre></td>
<td>The maximum number of cursors to allocate overall. Note that a pool is generate for each combination of filter, sort_by and key parameters.</td>
</tr>
<tr class="even">
<td><pre class="black-code"><code>eager-cursor-allocation-linear-slice-width</code></pre></td>
<td>Applies for the LINEAR policy. It is the width of a pool slice, i.e. the distance between two cursors clusters.</td>
</tr>
<tr class="odd">
<td><pre class="black-code"><code>eager-cursor-allocation-linear-slice-delta</code></pre></td>
<td><p>Applies for the LINEAR policy. Cursors are not preallocated exactly from the first request page, but Delta skips before.</p>
<p>This allows to cover the case when further requests are actually for a previous pages.</p></td>
</tr>
<tr class="even">
<td><pre class="black-code"><code>eager-cursor-allocation-linear-slice-heights</code></pre></td>
<td><p>Applies for the LINEAR policy. It is the number of clusters to generate and cursors to allocate</p>
<p>For instance the value [4,2,1] means to create 3 clusters, the first with 4 cursors, the second with 2 and the last with 1.</p></td>
</tr>
<tr class="odd">
<td><pre class="black-code"><code>eager-cursor-allocation-random-max-cursors</code></pre></td>
<td>Applies for the RANDOM policy. It is the the maximum number of cursors to allocate for each combination of filter, sort_by and key parameters.</td>
</tr>
<tr class="even">
<td><pre class="black-code"><code>eager-cursor-allocation-random-slice-min-width</code></pre></td>
<td>Applies for the RANDOM policy. It is the minimum width of a pool slice, i.e. the minimum distance between two cursors clusters.</td>
</tr>
</tbody>
</table>
</div>
  <h2 id="consideration-on-concurrent-insertions">Consideration on concurrent insertions</h2>

  <p>When iterating a cursor that uses an index for the sort, then:</p>

  <ul>
    <li>a document inserted <em>after</em> the cursor’s position will appear in the
results. </li>
    <li>a document inserted <em>before</em> the cursor’s position doesn’t affect
the cursor’s position or meaning of the current “skip”. </li>
  </ul>

  <p>When iterating a sorted cursor without an index, documents inserted
after the cursor will not appear in the results. Note that, if the
collection is big, sorting by properties that are not indexed is not a
good idea and will probably lead to a MongoDB error anyway.</p>

  <p>In this case, the <strong>eager=none</strong> parameter can be specified.</p>

</div>

    </div>
</div>
    </div>

    <footer class="bs-docs-footer mt-0">
  <!-- <script>!function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https'; if (!d.getElementById(id)) { js = d.createElement(s); js.id = id; js.src = p + '://platform.twitter.com/widgets.js'; fjs.parentNode.insertBefore(js, fjs); } }(document, 'script', 'twitter-wjs');</script> -->
  <div id="fb-root"></div>
  <section id="mainFooter">
    <div class="container-fluid">
      <div>
        <div class="bs-docs-social">
          <ul class="socialNetwork">
            <li class="ml-auto">
              <a href="https://twitter.com/softinstigate" class="tips" title="Follow us on Twitter" data-original-title="follow us on Twitter"
                target="_blank">
                <svg class="socialNetwork__icon"><use xlink:href="/images/sprite.svg#twitter" /></svg>
              </a>
            </li>
            <li>
              <a href="https://github.com/softinstigate/restheart" class="tips" title="Get the source code" data-original-title="get the source code"
                target="_blank">
                <svg class="socialNetwork__icon"><use xlink:href="/images/sprite.svg#github" /></svg>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div>
        Made with
        <!--<span class="glyphicon glyphicon-heart"></span>-->
        <svg class="footer__like"><use xlink:href="/images/sprite.svg#like" /></svg>
        by
        <a href="https://www.softinstigate.com" target="_blank">SoftInstigate</a>
      </div>
      <div>
        <a href="https://softinstigate.com/en/privacy" class="mr-2 small">Privacy Policy</a>
        <a href="https://www.iubenda.com/privacy-policy/15571002/cookie-policy" class="small iubenda-nostyle no-brand iubenda-embed " title="Cookie Policy">Cookie Policy</a>
      </div>
    </section>
</footer>

    <!-- End Document ================================================== -->
</body>

</html>
<!-- add copy button on code snippet -->
<script src="/assets/js/clipboard.min.js"></script>
<style>
    .listingblock:hover .clipboard {
        display: block;
    }

    .clipboard {
        display: none;
        border: 0;
        font-size: .75em;
        text-transform: uppercase;
        font-weight: 800;
        padding: 2px;
        color: #999;
        position: absolute;
        top: 6px;
        right: 10px;
        background: transparent;
    }

    code + .clipboard {
        padding: 0;
    }

    .clipboard:hover, .clipboard:focus, .clipboard:active {
        outline: 0;
        color: white;
        /* background-color: #eee9e6; */
    }
</style>
<!-- add copy button on code snippet -->
<script>
    window.onload = function() {
        function target(b) {
            var p = b.parentNode;
            if (p.className.includes("highlight")) {
                var elems = p.getElementsByTagName("code");
                if (elems.length > 0) {
                    return elems[0];
                }
            }
            return p.childNodes[0];
        }

        var pre = document.getElementsByTagName('pre');
        for (var i = 0; i < pre.length; i++) {
            var b = document.createElement('button');
            b.className = 'clipboard';
            b.textContent = 'Copy';
            // b.innerHTML = '<i style="font-size:18px" class="icon-clipboard"></i>';
            if (pre[i].childNodes.length === 1 && pre[i].childNodes[0].nodeType === 3) {
                var div = document.createElement('div');
                div.textContent = pre[i].textContent;
                pre[i].textContent = '';
                pre[i].appendChild(div);
            }
            pre[i].appendChild(b);
        }

        var clipboard = new ClipboardJS('.clipboard', {
            // this custom text function, remove any line that doesn't start with $
            text: function (trigger) {
                var t = target(trigger);
                const text = target(trigger).outerText;

                if (text) {
                    const dataLang = t.getAttribute('data-lang');
                    if (dataLang === 'bash') {
                        return text
                            .replace(/^(?!\$.*$).*/gm, '') // remove lines that don't start with $
                            .replace(/^\$ */gm, '') // remove leading $
                            .replace(/^\s*[\r\n]/gm, '') // remove blank lines
                            .replace(/^\s+|\s+$/gm, ''); // trim string
                    }
                }
            },
            target: target
        });
        clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.textContent = 'Copied';
            setTimeout(function() {
                e.trigger.textContent = 'Copy';
            }, 2000);
        });
        clipboard.on('error', function(e) {
            console.error('Action:', e.action, e);
            console.error('Trigger:', e.trigger);
        });
    };
</script>