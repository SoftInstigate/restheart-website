<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->

<html lang="en">
<!--<![endif]-->
<head>
   <meta charset="utf-8">
   <title>RESTHeart - Security Overview</title>
   <meta name="description" content="Low code API Framework for MongoDB">
   <meta name="author" content="SoftInstigate srl">
   <meta name="keywords" content="restheart,mongodb,rest,,graphql,api,http,microservice,java,framework">
   <!-- Open Graph -->
   <meta property="og:type" content="website">
   <meta property="og:url" content="https://restheart.org">
   <meta property="og:logo" content="/images/restheart logo.svg">
   <meta property="og:title" content="RESTHeart - Security Overview">
   <meta property="og:description" content="Low code API Framework for MongoDB">
   <meta property="og:locale" content="en">
   
   <!-- avoid search engine indexing of old documentation pages  -->
   <meta name="robots" content="noindex,nofollow">
   
   <!-- Mobile Specific Metas -->
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   <!-- icon fonts -->
   <script src="/js/fontawesome.com_c39cf060d4.js"></script>
   <link type="text/css" rel="stylesheet" href="/font-icons/custom-icons/css/custom-icons.css">
   <link type="text/css" rel="stylesheet" href="/font-icons/custom-icons/css/custom-icons-ie7.css">
   <!-- Custom css -->
   <link rel="stylesheet" type="text/css" href="/css/main.css">
   <!-- js ================================================== -->
   <script src="https://code.jquery.com/jquery.min.js"></script>
   <script src="/assets/js/bootstrap.bundle.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js"></script>
   <script src="https://unpkg.com/@stackblitz/sdk/bundles/sdk.umd.js"></script>
   <script src="/js/carousel.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.min.js"></script>
   <!-- Github buttons. -->
   <script async defer src="https://buttons.github.io/buttons.js"></script>
   <!--iframeResizer-->
  <script src="/assets/js/iframe-resizer.parent.js"></script>
   <!-- Favicons ================================================== -->
  <link rel="icon" type="image/svg+xml" href="/images/restheart logo.svg" />
  <link rel="shortcut icon" href="/images/favicon/favicon.png" />
  <link rel="canonical" href="https://restheart.org/docs/v4/security/overview">
  <link rel="alternate" type="application/atom+xml" title="RESTHeart - API Framework" href="https://restheart.org/feed.xml" />
  <script defer data-domain="restheart.org" src="https://plausible.io/js/script.js"></script>
</head>


<body>
    <header id="mainHeader" class="fixed-top background-primary" role="banner">
    <div class="container-fluid">
        <nav class="navbar navbar-default scrollMenu navbar-expand-lg" role="navigation">
            <a class="navbar-brand" href="/">
                <h2 class="text-white"><strong>REST</strong>Heart</h2>
            </a>
            <!-- Place this tag where you want the button to render. -->
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target=".navbar-ex1-collapse"><span
                    class="sr-only">Toggle navigation</span> &#x2630;</button>
            <div class="collapse navbar-collapse navbar-ex1-collapse background-primary" id="scrollTarget">
                <ul class="nav navbar-nav ml-md-auto">
                    <!-- only bounce slack button on home page-->
                    
                    

                    <li class="nav-item ml-1 ml-lg-2 ml-xl-4 mb-0 pb-0 ">
                        <a class="github-button" href="https://github.com/SoftInstigate/restheart" data-size="large" data-show-count="true" aria-label="Star SoftInstigate/restheart on GitHub"></a>
                    </li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/docs/sophia">Ask Sophia</a></li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/docs">Docs</a></li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/docs/faq">FAQ</a></li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/docs/setup-with-docker/">GET</a></li>
                    <li class="nav-item"><a class="ml-1 ml-lg-2 ml-xl-4" href="/contact">Contacts</a></li>
                </ul>
            </div>
        </nav>
    </div>
</header>

<div class="alert alert-warning m-0 text-center" role="alert">
    <strong>RESTHeart 8 is the current stable release. Switch documentation to <a href="/docs">v8</a></strong>
</div>



<a  target="_blank" class="gitter-open-chat-button fixed-bottom-right" href="https://join.slack.com/t/restheart/shared_invite/zt-1olrhtoq8-5DdYLBWYDonFGEALhmgSXQ"></a>


    <div class="page-content">
        <div class="container-fluid imgHover doc">
    <div class="row flex-xl-nowrap">
        <div class="col-12 col-md-3 col-xl-2 bd-sidebar">
            <div class="bd-sidebar__head">
                <div class="dropdown d-flex justify-content-center w-100">
                    <button class="btn btn-secondary dropdown-toggle w-100 p-1 mb-2" type="button"
                        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        v4
                    </button>
                    <div class="dropdown-menu mt-2 mr-1 pb-2" aria-labelledby="dropdownMenuButton">
                      <a class="dropdown-item" href="/docs">
                            
                            v8
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v7">
                            
                            v7
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v6">
                            
                            v6
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v5">
                            
                            v5
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v4">
                            
                            <strong>v4</strong>
                            
                        </a>
                        <a class="dropdown-item" href="/docs/v3">
                            
                            v3
                            
                        </a>
                    </div>
                </div>
                <form action="https://www.google.com/search" class="form bd-sidebar__search d-flex" method="get"
                    name="searchform" target="_blank">
                    <input name="sitesearch" type="hidden" value="restheart.org/docs">
                    <input autocomplete="on" class="form-control input-sm search bd-sidebar__input" name="q"
                        placeholder="Search" required="required" type="text">
                    <button class="bd-sidebar__submit" type="submit">
                        <svg width="16" height="16">
                            <use xlink:href="/images/sprite.svg#search" /></svg>
                    </button>
                </form>
                <div class="d-flex flex-wrap justify-content-between align-items-center">
                    <a href="https://github.com/SoftInstigate/restheart-website/edit/master/docs/v4/security/overview.md"
                        class="small mt-2 mb-1 ml-lg-auto"><i class="icon-pencil"></i>Edit Page</a>
                    <button class="btn btn-link bd-sidebar__toggle navbar-expand-md p-0 mb-1 d-md-none" type="button"
                        data-toggle="collapse" data-target="#bd-sidebar__menu" aria-controls="bd-sidebar__menu"
                        aria-expanded="false" aria-label="Toggle docs navigation">
                        Table of Contents
                        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 30 30" width="30" height="30"
                            focusable="false">
                            <title>Menu</title>
                            <path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10"
                                d="M4 7h22M4 15h22M4 23h22" />
                        </svg>
                    </button>
                </div>
            </div>

            <div class="bd-sidebar__menu collapse d-md-block" id="bd-sidebar__menu">
                
                    <h2 id="getting-started"><a href="/docs">Intoduction</a></h2>

<h2 id="getting-started">Getting Started</h2>
<ul>
    <li><a href="/docs/v4/setup">Setup</a></li>
    <li><a href="/docs/v4/configuration">Configuration</a></li>
    <li><a href="/docs/v4/tutorial">Absolute Beginner Tutorial</a></li>
    <li><a href="/docs/v4/quick-reference">Quick Reference</a></li>
    <li><a href="/docs/v4/resource-uri">Resource URIs</a></li>
    <li><a href="/docs/v4/representation-format">Representation Format</a></li>
    <li><a href="/docs/v4/blog-posts">Tutorials</a></li>
    <li><a href="/docs/v4/performances">Performances</a></li>
    <li><a href="/docs/v4/clustering">Clustering & Load Balancing</a></li>
</ul>

<h2 id="upgrading-from-3"><a href="/docs/v4/upgrade-to-v4">Upgrade to v4</a></h2>
<h2 id="upgrading-from-3"><a href="/docs/v4/roadmap">Roadmap</a></h2>

<h2 id="content-api">Content API</h2>
<ul>
    <li><a href="/docs/v4/read-docs">Read JSON Documents</a></li>
    <li><a href="/docs/v4/write-docs">Write JSON Documents</a></li>
    <li><a href="/docs/v4/files">Binary Files with GridFS</a></li>
    <li><a href="/docs/v4/aggregations">Aggregations</a></li>
    <li><a href="/docs/v4/csv">Upload CSV files</a></li>
    <li><a href="/docs/v4/json-schema-validation">JSON Schema Validation</a></li>
    <li><a href="/docs/v4/change-streams">Change Streams</a></li>
    <li><a href="/docs/v4/transactions">Transactions</a></li>
</ul>

<h2 id="mgmt-api">Management API</h2>
<ul>
    <li><a href="/docs/v4/mgmt/dbs-collections">Databases and Collections</a></li>
    <li><a href="/docs/v4/mgmt/indexes">Indexes</a></li>
    <li><a href="/docs/v4/mgmt/relationships">Relationships</a></li>
</ul>

<h2 id="security">Securing Requests</h2>
<ul>
    <li><a href="/docs/v4/security/overview">Overview</a></li>
    <li><a href="/docs/v4/security/authentication">Authentication</a></li>
    <li><a href="/docs/v4/security/authorization">Authorization</a></li>
    <li><a href="/docs/v4/security/user-management">User Management</a></li>
    <li><a href="/docs/v4/security/tls">Configure TLS</a></li>
    <li><a href="/docs/v4/security/secure-connection-to-mongodb">Secure connection to MongoDB</a></li>
    <li><a href="/docs/v4/security/how-clients-authenticate">How Clients Authenticate</a></li>
</ul>


<h2 id="plugins">Plugins</h2>
<ul>
    <li><a href="/docs/v4/plugins/overview">Overview</a></li>
    <li><a href="/docs/v4/plugins/apply">Apply plugins</a></li>
    <li><a href="/docs/v4/plugins/list">Available plugins</a></li>
</ul>

<h2 id="develop-core-plugins">Develop Plugins</h2>
<ul>
    <li><a href="/docs/v4/develop/core-plugins">Core Plugins</a></li>
    <li><a href="/docs/v4/develop/security-plugins">Security Plugins</a></li>
    <li><a href="/docs/v4/develop/packaging">Packaging Plugins</a></li>
    <li><a href="/docs/v4/develop/best-practices">Best practices</a></li>
</ul>

<h2 id="other-fatures">Other Features</h2>
<ul class="mb-5">
    <li><a href="/docs/v4/etag">ETag</a></li>
    <li><a href="/docs/v4/cors-support">CORS Support</a></li>
    <li><a href="/docs/v4/shard-keys">Shard Keys</a></li>
    <li><a href="/docs/v4/speedup-requests-with-cursor-pools">Cursor Pools</a></li>
    <li><a href="/docs/v4/monitoring">Monitoring</a></li>
    <li><a href="/docs/v4/auditing">Auditing</a></li>
</ul>

                
            </div>
        </div>
        <div class="d-none d-xl-block col-xl-2 order-last bd-toc">

  <ul>
    <li><a href="#introduction">Introduction </a></li>
    <li><a href="#features">Features</a></li>
    <li><a href="#use-cases">Use Cases</a></li>
    <li><a href="#how-it-works">How it works</a></li>
    <li><a href="#tutorial">Tutorial</a></li>
    <li><a href="#understanding-restheart-security">Understanding restheart-security</a></li>
  </ul>

</div>
<div class="col-12 col-md-9 col-xl-8 py-md-3 bd-content">

  <div class="docs-head d-flex align-items-center justify-content-between">
    <h2 class="d-flex align-items-center m-0 pr-3">
        <span>Security Overview</span>
    </h2>
</div>

  <h2 id="introduction">Introduction</h2>

  <p><strong>restheart-security</strong> is the security service for RESTHeart.</p>

  <p>It acts as a reverse proxy for HTTP resources, providing <strong>Authentication</strong> and <strong>Authorization</strong> services.</p>

  <p><strong>restheart-security</strong> enables developers to configure security policies in standardized micro-gateway instances that are external to API and micro-services implementations, avoiding coding security functions and a centralized gateway where scalability is a key concern.</p>

  <p><strong>restheart-security</strong> can also be used as a micro-gateway for <strong>Identity and Access Management</strong> in any HTTP-based micro-services architecture.</p>

  <p class="bs-callout bs-callout-info">Think about restheart-security as the “brick” that you put in front of your API and micro-services to protect them.</p>

  <p><strong>restheart-security</strong> is built around a <strong>pluggable architecture</strong>. It comes with a strong security implementation but you can easily extend it by implementing plugins.</p>

  <p class="bs-callout bs-callout-info">Building a plugin is as easy as implementing a simple interface and edit a configuration file. Plugins also allow to quickly implement and deploy secure Web Services.</p>

  <h2 id="features">Features</h2>

  <ul>
    <li>Identity and Access Management at <strong>HTTP protocol level</strong>.</li>
    <li>Placement within <strong>Docker containers</strong>, on the network layer and embeddable in Java applications.</li>
    <li>Can be extended via easy-to-implement plugins.</li>
    <li>Allows to quickly implement secured Web Services.</li>
    <li><strong>Basic</strong>, <strong>Digest</strong> and <strong>Token Authentication</strong>. Other authentication methods can be added with plugins.</li>
    <li><strong>Roles</strong> based Authorization with a powerful permission definition language. Other authorization methods can be added with plugins.</li>
    <li>Solid multi-threading, non-blocking architecture.</li>
    <li>High performance.</li>
    <li>Small memory footprint.</li>
    <li>Straightforward configuration.</li>
  </ul>

  <h2 id="use-cases">Use cases</h2>

  <h3 id="restheart-security-on-the-network-layer"><strong>restheart-security</strong> on the network layer</h3>

  <p>The following diagram shows a single instance of <strong>restheart-security</strong> placed on the network layer, in front of the resources to be protected. It acts as a centralized <strong>security policy enforcer</strong>.</p>

  <p><img src="/images/restheart-security-on-network-layer.png" alt="restheart-security on the network layer" title="restheart-security on the network layer" /></p>

  <h3 id="restheart-security-within-containers"><strong>restheart-security</strong> within containers</h3>

  <p>The following diagram shows <strong>restheart-security</strong> used as a sidecar proxy within each container pod. Each micro-service is protected by an instance of <strong>restheart-security</strong> with its own dedicated security policy.</p>

  <p><img src="/images/restheart-security-within-containers.png" alt="restheart-security within containers" title="restheart-security within containers" /></p>

  <h3 id="restheart-security-embedded"><strong>restheart-security</strong> embedded</h3>

  <p>The following diagram shows <strong>restheart-security</strong> used to implement a simple micro-service using service extensions.</p>

  <p><img src="/images/restheart-security-embedded.png" alt="restheart-security embedded" title="restheart-security embedded" /></p>

  <h2 id="how-it-works">How it works</h2>

  <p>The <code class="language-plaintext highlighter-rouge">restheart-security.yml</code> configuration file allows defining listeners and proxied resources in the first place.</p>

  <p>As an example, we are going to securely expose the resources of a RESTHeart server and Web Server running on a private network.</p>

  <p>The following options set a HTTPS listener bound to the public ip of <code class="language-plaintext highlighter-rouge">domain.io</code>.</p>

  <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">https-listener</span><span class="pi">:</span> <span class="no">true</span>
<span class="na">https-host</span><span class="pi">:</span> <span class="s">domain.io</span>
<span class="na">https-port</span><span class="pi">:</span> <span class="m">443</span>
</code></pre></div>  </div>

  <p>The two hosts in private network <code class="language-plaintext highlighter-rouge">10.0.1.0/24</code> are:</p>

  <ul>
    <li>the RESTHeart server running on host <code class="language-plaintext highlighter-rouge">10.0.1.1</code> that exposes the collection <code class="language-plaintext highlighter-rouge">/db/coll</code></li>
    <li>the web server running on host <code class="language-plaintext highlighter-rouge">10.0.1.2</code> bound to URI <code class="language-plaintext highlighter-rouge">/web</code></li>
  </ul>

  <p>We proxy them as follows:</p>

  <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">proxies</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">location</span><span class="pi">:</span> <span class="s">/api</span>
      <span class="na">proxy-pass</span><span class="pi">:</span> <span class="s">https://10.0.0.1/db/coll</span>
    <span class="pi">-</span> <span class="na">location</span><span class="pi">:</span> <span class="s">/</span>
      <span class="na">proxy-pass</span><span class="pi">:</span> <span class="s">https://10.0.0.2/web</span>
</code></pre></div>  </div>

  <p>As a result, the URLs <code class="language-plaintext highlighter-rouge">https://domain.io</code> and <code class="language-plaintext highlighter-rouge">https://domain.io/api</code> are proxied to the resources specified by the <code class="language-plaintext highlighter-rouge">proxy-pass</code> URLs. All requests from the external network pass through <strong>restheart-security</strong> that enforces authentication and authorization.</p>

  <div class="d-flex mt-2 mb-2">
    
    <span class="mr-3 text-muted"><strong>Request</strong></span>
    
    
</div>

  <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/index.html</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</code></pre></div>  </div>

  <div class="d-flex mt-2 mb-2">
    
    <span class="mr-3 text-muted"><strong>Response</strong></span>
    
    
</div>

  <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">401</span> <span class="ne">Unauthorized</span>
</code></pre></div>  </div>

  <div class="d-flex mt-2 mb-2">
    
    <span class="mr-3 text-muted"><strong>Request</strong></span>
    
    
</div>

  <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">https://domain.io/api</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</code></pre></div>  </div>

  <div class="d-flex mt-2 mb-2">
    
    <span class="mr-3 text-muted"><strong>Response</strong></span>
    
    
</div>

  <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">401</span> <span class="ne">Unauthorized</span>
</code></pre></div>  </div>

  <p>With the default configuration <strong>restheart-security</strong> uses the Basic Authentication with credentials and permission defined in <code class="language-plaintext highlighter-rouge">users.yml</code> and <code class="language-plaintext highlighter-rouge">acl.yml</code> configuration files respectively:</p>

  <h4 id="usersyml">users.yml</h4>

  <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">users</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">userid</span><span class="pi">:</span> <span class="s">user</span>
      <span class="na">password</span><span class="pi">:</span> <span class="s">secret</span>
      <span class="na">roles</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">web</span><span class="pi">,</span> <span class="nv">api</span><span class="pi">]</span>
</code></pre></div>  </div>

  <h3 id="aclyml">acl.yml</h3>

  <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">permissions</span><span class="pi">:</span>
    <span class="c1"># Users with role 'web' can GET web resources</span>
    <span class="pi">-</span> <span class="na">role</span><span class="pi">:</span> <span class="s">web</span>
      <span class="na">predicate</span><span class="pi">:</span> <span class="s">path-prefix[path=/] and not path-prefix[path=/api] and method[GET]</span>

    <span class="c1"># Users with role 'api' can GET and POST /api resources</span>
    <span class="pi">-</span> <span class="na">role</span><span class="pi">:</span> <span class="s">api</span>
      <span class="na">predicate</span><span class="pi">:</span> <span class="s">path-prefix[path=/api] and (method[GET] or method[POST])</span>
</code></pre></div>  </div>

  <div class="d-flex mt-2 mb-2">
    
    <span class="mr-3 text-muted"><strong>Request</strong></span>
    
    
</div>

  <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/index.html</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Basic dXNlcjpzZWNyZXQ=</span>
</code></pre></div>  </div>

  <div class="d-flex mt-2 mb-2">
    
    <span class="mr-3 text-muted"><strong>Response</strong></span>
    
    
</div>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 200 OK
...
</code></pre></div>  </div>

  <div class="d-flex mt-2 mb-2">
    
    <span class="mr-3 text-muted"><strong>Request</strong></span>
    
    
</div>

  <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/api</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Basic dXNlcjpzZWNyZXQ=</span>
</code></pre></div>  </div>

  <div class="d-flex mt-2 mb-2">
    
    <span class="mr-3 text-muted"><strong>Response</strong></span>
    
    
</div>

  <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="s">...</span>
</code></pre></div>  </div>

  <h2 id="tutorial">Tutorial</h2>

  <p>To follow this tutorial you need <a href="https://httpie.org" target="_blank">httpie</a>, a modern command line HTTP client made in Python which is easy to use and produces a colorized and indented output.</p>

  <p>Add to <strong>restheart-platform-security.yml</strong> the following proxy:</p>

  <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">proxies</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">location</span><span class="pi">:</span> <span class="s">/secho</span>
      <span class="na">proxy-pass</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">http://localhost:8080/echo</span>
</code></pre></div>  </div>

  <p class="bs-callout bs-callout-info">the service <code class="language-plaintext highlighter-rouge">/echo</code> just echoes back the request (URL, query parameters, body and headers). It is defined in the configuration file as follows:</p>

  <div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">services</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">implementation-class</span><span class="pi">:</span> <span class="s">org.restheart.security.plugins.services.EchoService</span>
      <span class="na">uri</span><span class="pi">:</span> <span class="s">/echo</span>
      <span class="na">secured</span><span class="pi">:</span> <span class="no">false</span>
</code></pre></div>  </div>

  <p class="bs-callout bs-callout-info">Note that <code class="language-plaintext highlighter-rouge">/echo</code> is not secured and can be invoked without restrictions.</p>

  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>http <span class="nt">-f</span> 127.0.0.1:8080/echo?qparam<span class="o">=</span>value header:value <span class="nv">a</span><span class="o">=</span>1 <span class="nv">b</span><span class="o">=</span>2
HTTP/1.1 200 OK
Access-Control-Allow-Credentials: <span class="nb">true
</span>Access-Control-Allow-Origin: <span class="k">*</span>
Access-Control-Expose-Headers: Location
Access-Control-Expose-Headers: Location, ETag, Auth-Token, Auth-Token-Valid-Until, Auth-Token-Location, X-Powered-By
Connection: keep-alive
Content-Encoding: <span class="nb">gzip
</span>Content-Length: 341
Content-Type: application/json
Date: Mon, 18 Feb 2019 17:25:19 GMT
X-Powered-By: restheart.org

<span class="o">{</span>
    <span class="s2">"URL"</span>: <span class="s2">"http://127.0.0.1:8080/echo"</span>,
    <span class="s2">"content"</span>: <span class="s2">"a=1&amp;b=2"</span>,
    <span class="s2">"headers"</span>: <span class="o">{</span>
        <span class="s2">"Accept"</span>: <span class="o">[</span>
            <span class="s2">"*/*"</span>
        <span class="o">]</span>,
        <span class="s2">"Accept-Encoding"</span>: <span class="o">[</span>
            <span class="s2">"gzip, deflate"</span>
        <span class="o">]</span>,
        <span class="s2">"Connection"</span>: <span class="o">[</span>
            <span class="s2">"keep-alive"</span>
        <span class="o">]</span>,
        <span class="s2">"Content-Length"</span>: <span class="o">[</span>
            <span class="s2">"7"</span>
        <span class="o">]</span>,
        <span class="s2">"Content-Type"</span>: <span class="o">[</span>
            <span class="s2">"application/x-www-form-urlencoded; charset=utf-8"</span>
        <span class="o">]</span>,
        <span class="s2">"Host"</span>: <span class="o">[</span>
            <span class="s2">"127.0.0.1:8080"</span>
        <span class="o">]</span>,
        <span class="s2">"User-Agent"</span>: <span class="o">[</span>
            <span class="s2">"HTTPie/1.0.2"</span>
        <span class="o">]</span>,
        <span class="s2">"header"</span>: <span class="o">[</span>
            <span class="s2">"value"</span>
        <span class="o">]</span>
    <span class="o">}</span>,
    <span class="s2">"method"</span>: <span class="s2">"POST"</span>,
    <span class="s2">"note"</span>: <span class="s2">"showing up to 20 bytes of the request content"</span>,
    <span class="s2">"prop2"</span>: <span class="s2">"property added by example response interceptor"</span>,
    <span class="s2">"qparams"</span>: <span class="o">{</span>
        <span class="s2">"pagesize"</span>: <span class="o">[</span>
            <span class="s2">"0"</span>
        <span class="o">]</span>,
        <span class="s2">"qparam"</span>: <span class="o">[</span>
            <span class="s2">"value"</span>
        <span class="o">]</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>  </div>

  <p>Let’s try now to invoke <code class="language-plaintext highlighter-rouge">/secho</code> (please note the leading ‘s’) without passing authentication credentials. This will fail with <code class="language-plaintext highlighter-rouge">401 Unauthorized</code> HTTP response.</p>

  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>http <span class="nt">-f</span> 127.0.0.1:8080/secho?qparam<span class="o">=</span>value header:value <span class="nv">a</span><span class="o">=</span>1 <span class="nv">b</span><span class="o">=</span>2

HTTP/1.1 401 Unauthorized
Connection: keep-alive
Content-Length: 0
Date: Mon, 18 Feb 2019 17:26:04 GMT
WWW-Authenticate: Basic <span class="nv">realm</span><span class="o">=</span><span class="s2">"RESTHeart Realm"</span>
WWW-Authenticate: Digest <span class="nv">realm</span><span class="o">=</span><span class="s2">"RESTHeart Realm"</span>,domain<span class="o">=</span><span class="s2">"localhost"</span>,nonce<span class="o">=</span><span class="s2">"Z+fsw9eFwPgNMTU1MDUxMDc2NDA2NmFWzLOw/aaHdtjyi0jm5uE="</span>,opaque<span class="o">=</span><span class="s2">"00000000000000000000000000000000"</span>,algorithm<span class="o">=</span>MD5,qop<span class="o">=</span><span class="s2">"auth"</span>
</code></pre></div>  </div>

  <p>Let’s try now to pass credentials via basic authentication. The user <code class="language-plaintext highlighter-rouge">admin</code> is defined in the <code class="language-plaintext highlighter-rouge">users.yml</code> file.</p>

  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>http <span class="nt">-a</span> admin:changeit <span class="nt">-f</span> 127.0.0.1:8080/secho?qparam<span class="o">=</span>value header:value <span class="nv">a</span><span class="o">=</span>1 <span class="nv">b</span><span class="o">=</span>2

HTTP/1.1 200 OK
Access-Control-Allow-Credentials: <span class="nb">true
</span>Access-Control-Allow-Origin: <span class="k">*</span>
Access-Control-Expose-Headers: Location
Access-Control-Expose-Headers: Location, ETag, Auth-Token, Auth-Token-Valid-Until, Auth-Token-Location, X-Powered-By
Auth-Token: 5iojkf21pdul7layo3qultyes7qyt8obdm1u67hkmnw6l39ckm
Auth-Token-Location: /tokens/admin
Auth-Token-Valid-Until: 2019-02-18T17:41:25.142209Z
Connection: keep-alive
Content-Encoding: <span class="nb">gzip
</span>Content-Length: 427
Content-Type: application/json
Date: Mon, 18 Feb 2019 17:26:25 GMT
X-Powered-By: restheart.org

<span class="o">{</span>
    <span class="s2">"URL"</span>: <span class="s2">"http://localhost:8080/echo"</span>,
    <span class="s2">"content"</span>: <span class="s2">"a=1&amp;b=2"</span>,
    <span class="s2">"headers"</span>: <span class="o">{</span>
        <span class="s2">"Accept"</span>: <span class="o">[</span>
            <span class="s2">"*/*"</span>
        <span class="o">]</span>,
        <span class="s2">"Accept-Encoding"</span>: <span class="o">[</span>
            <span class="s2">"gzip, deflate"</span>
        <span class="o">]</span>,
        <span class="s2">"Connection"</span>: <span class="o">[</span>
            <span class="s2">"keep-alive"</span>
        <span class="o">]</span>,
        <span class="s2">"Content-Length"</span>: <span class="o">[</span>
            <span class="s2">"7"</span>
        <span class="o">]</span>,
        <span class="s2">"Content-Type"</span>: <span class="o">[</span>
            <span class="s2">"application/x-www-form-urlencoded; charset=utf-8"</span>
        <span class="o">]</span>,
        <span class="s2">"Host"</span>: <span class="o">[</span>
            <span class="s2">"localhost:8080"</span>
        <span class="o">]</span>,
        <span class="s2">"User-Agent"</span>: <span class="o">[</span>
            <span class="s2">"HTTPie/1.0.2"</span>
        <span class="o">]</span>,
        <span class="s2">"X-Forwarded-Account-Id"</span>: <span class="o">[</span>
            <span class="s2">"admin"</span>
        <span class="o">]</span>,
        <span class="s2">"X-Forwarded-Account-Roles"</span>: <span class="o">[</span>
            <span class="s2">"user,admin"</span>
        <span class="o">]</span>,
        <span class="s2">"X-Forwarded-For"</span>: <span class="o">[</span>
            <span class="s2">"127.0.0.1"</span>
        <span class="o">]</span>,
        <span class="s2">"X-Forwarded-Host"</span>: <span class="o">[</span>
            <span class="s2">"127.0.0.1:8080"</span>
        <span class="o">]</span>,
        <span class="s2">"X-Forwarded-Port"</span>: <span class="o">[</span>
            <span class="s2">"8080"</span>
        <span class="o">]</span>,
        <span class="s2">"X-Forwarded-Proto"</span>: <span class="o">[</span>
            <span class="s2">"http"</span>
        <span class="o">]</span>,
        <span class="s2">"X-Forwarded-Server"</span>: <span class="o">[</span>
            <span class="s2">"127.0.0.1"</span>
        <span class="o">]</span>,
        <span class="s2">"header"</span>: <span class="o">[</span>
            <span class="s2">"value"</span>
        <span class="o">]</span>
    <span class="o">}</span>,
    <span class="s2">"method"</span>: <span class="s2">"POST"</span>,
    <span class="s2">"note"</span>: <span class="s2">"showing up to 20 bytes of the request content"</span>,
    <span class="s2">"prop2"</span>: <span class="s2">"property added by example response interceptor"</span>,
    <span class="s2">"qparams"</span>: <span class="o">{</span>
        <span class="s2">"pagesize"</span>: <span class="o">[</span>
            <span class="s2">"0"</span>
        <span class="o">]</span>,
        <span class="s2">"qparam"</span>: <span class="o">[</span>
            <span class="s2">"value"</span>
        <span class="o">]</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>  </div>

  <p>We can note that <strong>restheart-security</strong>:</p>

  <ul>
    <li>has checked the credential specified in <code class="language-plaintext highlighter-rouge">users.yml</code> passed via Basic Authentication and proxied the request</li>
    <li>has determined the account roles. The proxied request includes the headers <code class="language-plaintext highlighter-rouge">X-Forwarded-Account-Id</code> and <code class="language-plaintext highlighter-rouge">X-Forwarded-Account-Roles</code>.</li>
    <li>has checked the permission specified in <code class="language-plaintext highlighter-rouge">acl.yml</code> for the account roles and determined that the request could be executed.</li>
    <li>the response headers include the header <code class="language-plaintext highlighter-rouge">Auth-Token</code>. Its value can be used in place of the actual password in the Basic Authentication until its expiration. This is useful in Web Applications, for storing in the browser the less sensitive auth token instead of full username and password.</li>
  </ul>

  <h2 id="understanding-restheart-security">Understanding <strong>restheart-security</strong></h2>

  <p>In <strong>restheart-security</strong> everything is a plugin including Authentication Mechanisms, Authenticators, Authorizers, Token Managers and Services.</p>

  <p><img src="/images/restheart-security-explained.png" alt="restheart-security explained" title="restheart-security explained" /></p>

  <p>Different <strong>Authentication Mechanism</strong> manage different authentication schemes.
An example is <em>BasicAuthMechanism</em> that handles the Basic Authentication scheme. It extracts the credentials from a request header and passes them to the an Authenticator for verification.</p>

  <p>A different example is the <em>IdentityAuthMechanism</em> that binds the request to a single identity specified by configuration. This Authentication Mechanism does not require an Authenticator to build the account.</p>

  <p><strong>restheart-security</strong> allows defining several mechanism. As an in-bound request is received, the <code class="language-plaintext highlighter-rouge">authenticate()</code> method is called on each mechanism in turn until one of the following occurs:</p>

  <ul>
    <li>A mechanism successfully authenticates the incoming request → the request proceeds to Authorization phase;</li>
    <li>The list of mechanisms is exhausted → the request fails with code <code class="language-plaintext highlighter-rouge">401 Unauthorized</code>.</li>
  </ul>

  <p>The <strong>Authenticator</strong> verifies the credentials extracted from the request by Authentication Mechanism. For instance, the <em>BasicAuthMechanism</em> extracts the credentials from the request in the form of id and password. The Authenticator can check these credentials against a database or a LDAP server. Note that some Authentication Mechanisms don’t actually rely on a Authenticator to build the Account.</p>

  <p>The <strong>Authorizer</strong> is responsible of checking if the user can actually perform the request against an Access Control List. For instance the <em>RequestPredicatesAuthorizer</em> checks if the request is allowed by looking at the role based permissions defined using the undertow predicate definition language.</p>

  <p>The <strong>Token Manager</strong> is responsible of generating and validating an auth-token. When a client successfully authenticates, the Token Manager generates an auth-token that is returned in the <code class="language-plaintext highlighter-rouge">Auth-Token</code> response header. It can be used to authenticate further requests. This requires an Authentication Manager to handle it using the Token Manager for token validation.</p>

  <p>A <strong>Service</strong> is a quick way of implementing Web Services to expose additional custom logic.</p>
</div>

    </div>
</div>
    </div>

    <footer class="bs-docs-footer mt-0">
  <!-- <script>!function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https'; if (!d.getElementById(id)) { js = d.createElement(s); js.id = id; js.src = p + '://platform.twitter.com/widgets.js'; fjs.parentNode.insertBefore(js, fjs); } }(document, 'script', 'twitter-wjs');</script> -->
  <div id="fb-root"></div>
  <section id="mainFooter">
    <div class="container-fluid">
      <div>
        <div class="bs-docs-social">
          <ul class="socialNetwork">
            <li class="ml-auto">
              <a href="https://twitter.com/softinstigate" class="tips" title="Follow us on Twitter" data-original-title="follow us on Twitter"
                target="_blank">
                <svg class="socialNetwork__icon"><use xlink:href="/images/sprite.svg#twitter" /></svg>
              </a>
            </li>
            <li>
              <a href="https://github.com/softinstigate/restheart" class="tips" title="Get the source code" data-original-title="get the source code"
                target="_blank">
                <svg class="socialNetwork__icon"><use xlink:href="/images/sprite.svg#github" /></svg>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div>
        Made with
        <!--<span class="glyphicon glyphicon-heart"></span>-->
        <svg class="footer__like"><use xlink:href="/images/sprite.svg#like" /></svg>
        by
        <a href="https://www.softinstigate.com" target="_blank">SoftInstigate</a>
      </div>
      <div>
        <a href="https://softinstigate.com/en/privacy" class="mr-2 small">Privacy Policy</a>
        <a href="https://www.iubenda.com/privacy-policy/15571002/cookie-policy" class="small iubenda-nostyle no-brand iubenda-embed " title="Cookie Policy">Cookie Policy</a>
      </div>
    </section>
</footer>

    <!-- End Document ================================================== -->
</body>

</html>
<!-- add copy button on code snippet -->
<script src="/assets/js/clipboard.min.js"></script>
<style>
    .listingblock:hover .clipboard {
        display: block;
    }

    .clipboard {
        display: none;
        border: 0;
        font-size: .75em;
        text-transform: uppercase;
        font-weight: 800;
        padding: 2px;
        color: #999;
        position: absolute;
        top: 6px;
        right: 10px;
        background: transparent;
    }

    code + .clipboard {
        padding: 0;
    }

    .clipboard:hover, .clipboard:focus, .clipboard:active {
        outline: 0;
        color: white;
        /* background-color: #eee9e6; */
    }
</style>
<!-- add copy button on code snippet -->
<script>
    window.onload = function() {
        function target(b) {
            var p = b.parentNode;
            if (p.className.includes("highlight")) {
                var elems = p.getElementsByTagName("code");
                if (elems.length > 0) {
                    return elems[0];
                }
            }
            return p.childNodes[0];
        }

        var pre = document.getElementsByTagName('pre');
        for (var i = 0; i < pre.length; i++) {
            var b = document.createElement('button');
            b.className = 'clipboard';
            b.textContent = 'Copy';
            // b.innerHTML = '<i style="font-size:18px" class="icon-clipboard"></i>';
            if (pre[i].childNodes.length === 1 && pre[i].childNodes[0].nodeType === 3) {
                var div = document.createElement('div');
                div.textContent = pre[i].textContent;
                pre[i].textContent = '';
                pre[i].appendChild(div);
            }
            pre[i].appendChild(b);
        }

        var clipboard = new ClipboardJS('.clipboard', {
            // this custom text function, remove any line that doesn't start with $
            text: function (trigger) {
                var t = target(trigger);
                const text = target(trigger).outerText;

                if (text) {
                    const dataLang = t.getAttribute('data-lang');
                    if (dataLang === 'bash') {
                        return text
                            .replace(/^(?!\$.*$).*/gm, '') // remove lines that don't start with $
                            .replace(/^\$ */gm, '') // remove leading $
                            .replace(/^\s*[\r\n]/gm, '') // remove blank lines
                            .replace(/^\s+|\s+$/gm, ''); // trim string
                    }
                }
            },
            target: target
        });
        clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.textContent = 'Copied';
            setTimeout(function() {
                e.trigger.textContent = 'Copy';
            }, 2000);
        });
        clipboard.on('error', function(e) {
            console.error('Action:', e.action, e);
            console.error('Trigger:', e.trigger);
        });
    };
</script>