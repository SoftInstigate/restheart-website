---
title: WebSocket API
layout: docs-adoc
---

== The WebSocket API (WebSockets)

_The WebSocket API is an advanced technology that makes it possible to open a two-way interactive communication session between the user's browser and a server. With this API, you can send messages to a server and receive event-driven responses without having to poll the server for a reply._

Ref: kink:https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API

[![Websocket_connection](https://upload.wikimedia.org/wikipedia/commons/1/10/Websocket_connection.png)](https://en.wikipedia.org/wiki/WebSocket)

== MongoDB Change Streams

_Change streams allow applications to access real-time data changes without the complexity and risk of tailing the oplog. Applications can use change streams to subscribe to all data changes on a single collection, a database, or an entire deployment, and immediately react to them. Because change streams use the aggregation framework, applications can also filter for specific changes or transform the notifications at will._

Ref: [https://docs.mongodb.com/manual/changeStreams/](https://docs.mongodb.com/manual/changeStreams/)

== RESTHeart WebSockets

__RESTHeart embeds a WebSocket server implementation__ that allows to expose MongoDB's Change Streams to Web browsers and any kind of HTTP/WebSocket client (for example, [Postman](https://learning.postman.com/docs/sending-requests/supported-api-frameworks/websocket/) offers this feature). 

With RESTHeart is possible to __create Web or Mobile apps that can be asynchronously notified in real time of data changes__. Because change streams use the [aggregation framework](https://docs.mongodb.com/manual/aggregation/), applications can also filter for specific changes.

For example, if the stream `all` is defined on the collection `messages`, clients can connect via WebSocket to `ws://mydomain.com/messages/_streams/all` and receive real time notification of data changes occurring in the collection.

++++
<img src="/images/changes-stream.png" width="80%" height="auto" class="image-center img-responsive" />
++++

Exposing a [WebSocket Server](https://tools.ietf.org/html/rfc6455) resource, clients may be promptly notified about these changes only if necessary, avoiding network expensive common practices like polling.

++++
<div class="alert alert-success" role="alert">
    <h2 class="alert-heading"><strong>Blazing fast.</strong></h2>
    <hr class="my-2">
    <p>Handle hundreds of thousands of concurrent clients.</p>
    <p>Check the <a class="alert-link" href="/docs/performances">performance tests</a>!</p>
</div>
++++

NOTE:  Change streams require at least MongoDB v3.6 configured as a link:https://docs.mongodb.com/manual/replication/[Replica Set]

NOTE: Starting from RESTHeart 5.3.0, when the `stream` collection metadata is modified or the collection or the db is deleted, all related WebSocket connections are closed and the change streams are consequently updated.